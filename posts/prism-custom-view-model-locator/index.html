<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="Prism: View Model Locator =&gt; Custom Convention" /><meta property="og:locale" content="en" /><meta name="description" content="How to implement a custom ViewModelLocator Convention to load view models from other separated assemblies without having the same namespace" /><meta property="og:description" content="How to implement a custom ViewModelLocator Convention to load view models from other separated assemblies without having the same namespace" /><link rel="canonical" href="https://cyounes.com/posts/prism-custom-view-model-locator/" /><meta property="og:url" content="https://cyounes.com/posts/prism-custom-view-model-locator/" /><meta property="og:site_name" content="Younesâ€™s blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2016-01-24T00:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Prism: View Model Locator =&gt; Custom Convention" /><meta name="twitter:site" content="@YounesCheikh" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-03-05T01:23:29+01:00","datePublished":"2016-01-24T00:00:00+01:00","description":"How to implement a custom ViewModelLocator Convention to load view models from other separated assemblies without having the same namespace","headline":"Prism: View Model Locator =&gt; Custom Convention","mainEntityOfPage":{"@type":"WebPage","@id":"https://cyounes.com/posts/prism-custom-view-model-locator/"},"url":"https://cyounes.com/posts/prism-custom-view-model-locator/"}</script><title>Prism: View Model Locator => Custom Convention | Younes's blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Younes's blog"><meta name="application-name" content="Younes's blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /Content/Images/avatar-YounesCheikh.PNG " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Younes's blog</a></div><div class="site-subtitle font-italic">Personal blog by Younes Cheikh</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/projects/" class="nav-link"> <i class="fa-fw fa fa-cubes ml-xl-3 mr-xl-3 unloaded"></i> <span>PROJECTS</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/YounesCheikh" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/YounesCheikh" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://stackoverflow.com/users/945317/somecode-net" aria-label="stack-overflow" target="_blank" rel="noopener"> <i class="fab fa-stack-overflow"></i> </a> <a href="https://www.linkedin.com/in/YounesCheikh/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Prism: View Model Locator => Custom Convention</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Prism: View Model Locator => Custom Convention</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/YounesCheikh">Younes Cheikh</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1453590000" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2016-01-24 </em> </span> <span> Updated <em class="timeago" data-ts="1646439809" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-03-05 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="847 words"> <em>4 min</em> read</span></div></div></div><div class="post-content"><p><img data-src="https://avatars3.githubusercontent.com/u/10503161?v=3" alt="PRISM" width="100" class="left" data-proofer-ignore> I was working on a modular/composite application using <a href="https://github.com/PrismLibrary/Prism">Prism</a> and <a href="https://msdn.microsoft.com/en-us/library/dd460648(v=vs.110).aspx">MEF</a>. One of the most issues i encountered, was using the Prism ViewModelLocator to bind the view context to the right view model instance. After googling, I had to write my own convention basing on Prism default convention. the new custom convention allows me to bind view models not necessary having the same namespace as the view namespace. also makes it possible to bind these view models event if are in another separated assembly.</p><div class="language-xml highlighter-rouge"><div class="code-header"> <span data-label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>	mvvm:ViewModelLocator.AutoWireViewModel="True"
</pre></table></code></div></div><p>I started by creating an interface named <em>IMvvmTypeLocator</em> :</p><div class="language-csharp highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="k">public</span> <span class="k">interface</span> <span class="nc">IMvvmTypeLocator</span>
<span class="p">{</span>
	<span class="c1">/// &lt;summary&gt;</span>
	<span class="c1">/// Gets the type of the view model from view type.</span>
	<span class="c1">/// &lt;/summary&gt;</span>
	<span class="c1">/// &lt;param name="viewType"&gt;Type of the view.&lt;/param&gt;</span>
	<span class="c1">/// &lt;returns&gt;The view model type if located; otherwise null&lt;/returns&gt;</span>
	<span class="n">Type</span> <span class="nf">GetViewModelTypeFromViewType</span><span class="p">(</span><span class="n">Type</span> <span class="n">viewType</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>The interface above has initially 3 methods, i will focus-on and share only the first one (<strong>GetViewModelTypeFromViewType(Type viewType)</strong>) to acheive my goal. <del>the 2 other methods are helpful for me to do the same but to locate the view type from a gived view model type or a given view name.</del></p><h3 id="implement-the-interface"><span class="mr-2">Implement the interface</span><a href="#implement-the-interface" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>I created a class to implement the interface IMvvmTypeLocator, this class has the <strong>AggregateCatalog</strong> as constructor argument.</p><blockquote><p>Note that we are going to create a custom convention to locate the target view models in all registered assembly catalogs</p></blockquote><h4 id="what-the-method-getviewmodeltypefromviewtype-does-"><span class="mr-2">What the method GetViewModelTypeFromViewType does ?</span><a href="#what-the-method-getviewmodeltypefromviewtype-does-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>This method starts by applying the default PRISM convention (<strong>GetDefaultViewModelTypeFromViewType</strong> method) to locate the target view model, if no view model located, then apply the custom one.</p><h5 id="1st-step"><span class="mr-2">1st step</span><a href="#1st-step" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5></h5><ul><li>Get the loaded assemblies from the aggregate catalog:<ul><li>All the assemblies added to the aggregate catalog in the BootStrapper.</ul></ul><h5 id="2nd-step"><span class="mr-2">2nd step</span><a href="#2nd-step" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5></h5><ul><li>Locate all non-abstracte classes inheriting from BindableBase class of PRISM (supposed to be a view models).</ul><h5 id="3rd-step"><span class="mr-2">3rd step</span><a href="#3rd-step" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5></h5><ul><li>The type name ends with the extension â€˜ViewModelâ€™<li>If the view type name ends with the extesnion â€˜Viewâ€™:<ul><li>Locate the type name without the extension â€˜ViewModelâ€™ equals to the view type name without the extension â€˜Viewâ€™.</ul><li>If the view type name doesnâ€™t end with the extension â€˜Viewâ€™:<ul><li>Locate the type name without the extension â€˜ViewModelâ€™ equals the view type name.</ul></ul><h4 id="example"><span class="mr-2">Example</span><a href="#example" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>If you added the assembly MyAssembly1.dll (contains the view models inside whatever their namespaces) to the assembly catalog. This custom convention will search inside this assembly for the target view model. If your view named <strong>Main</strong>View or <strong>Main</strong>: The convention will look for all the non-abstract classes ineheriting from BindableBase class, and named <strong>Main</strong>ViewModel.</p><h3 id="source"><span class="mr-2">Source</span><a href="#source" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-csharp highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
</pre><td class="rouge-code"><pre><span class="k">public</span> <span class="k">class</span> <span class="nc">MvvmTypeLocator</span><span class="p">:</span> <span class="n">IMvvmTypeLocator</span>
<span class="p">{</span>
	<span class="c1">/// &lt;summary&gt;</span>
	<span class="c1">/// The aggregate catalog</span>
	<span class="c1">/// &lt;/summary&gt;</span>
	<span class="k">private</span> <span class="n">AggregateCatalog</span> <span class="n">AggregateCatalog</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

	<span class="k">public</span> <span class="nf">MvvmTypeLocator</span><span class="p">(</span><span class="n">AggregateCatalog</span> <span class="n">aggregateCatalog</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">this</span><span class="p">.</span><span class="n">AggregateCatalog</span> <span class="p">=</span> <span class="n">aggregateCatalog</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">public</span> <span class="n">Type</span> <span class="nf">GetViewModelTypeFromViewType</span><span class="p">(</span><span class="n">Type</span> <span class="n">sourceType</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="c1">// The default prism view model type resolver as Priority</span>
		<span class="n">Type</span> <span class="n">targetType</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="nf">GetDefaultViewModelTypeFromViewType</span><span class="p">(</span><span class="n">sourceType</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">targetType</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="k">return</span> <span class="n">targetType</span><span class="p">;</span>
		<span class="p">}</span>

		<span class="c1">// Get assembly catalogs</span>
		<span class="kt">var</span> <span class="n">assemblyCatalogs</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">AggregateCatalog</span><span class="p">.</span><span class="n">Catalogs</span><span class="p">.</span><span class="nf">Where</span><span class="p">(</span><span class="n">c</span> <span class="p">=&gt;</span> <span class="n">c</span> <span class="k">is</span> <span class="n">AssemblyCatalog</span><span class="p">);</span>

		<span class="c1">// Get all exported types inherit from BindableBase prism class</span>
		<span class="kt">var</span> <span class="n">bindableBases</span> <span class="p">=</span>
			<span class="n">assemblyCatalogs</span><span class="p">.</span><span class="nf">Select</span><span class="p">(</span>
				<span class="n">c</span> <span class="p">=&gt;</span>
				<span class="p">((</span><span class="n">AssemblyCatalog</span><span class="p">)</span><span class="n">c</span><span class="p">).</span><span class="n">Assembly</span><span class="p">.</span><span class="nf">GetExportedTypes</span><span class="p">()</span>
					<span class="p">.</span><span class="nf">Where</span><span class="p">(</span><span class="n">t</span> <span class="p">=&gt;</span> <span class="p">!</span><span class="n">t</span><span class="p">.</span><span class="n">IsAbstract</span> <span class="p">&amp;&amp;</span> <span class="n">t</span><span class="p">.</span><span class="nf">IsSubclassOf</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">BindableBase</span><span class="p">)))</span>
					<span class="p">.</span><span class="nf">Select</span><span class="p">(</span><span class="n">t</span> <span class="p">=&gt;</span> <span class="n">t</span><span class="p">)).</span><span class="nf">SelectMany</span><span class="p">(</span><span class="n">b</span> <span class="p">=&gt;</span>
					<span class="p">{</span>
						<span class="kt">var</span> <span class="n">types</span> <span class="p">=</span> <span class="n">b</span> <span class="k">as</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">Type</span><span class="p">&gt;</span> <span class="p">??</span> <span class="n">b</span><span class="p">.</span><span class="nf">ToList</span><span class="p">();</span>
						<span class="k">return</span> <span class="n">types</span><span class="p">;</span>
					<span class="p">}).</span><span class="nf">Distinct</span><span class="p">();</span>

		<span class="c1">// Get the type where the delegate is applied</span>
		<span class="kt">var</span> <span class="n">customConvention</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Func</span><span class="p">&lt;</span><span class="n">Type</span><span class="p">,</span> <span class="kt">bool</span><span class="p">&gt;(</span>
			<span class="p">(</span><span class="n">Type</span> <span class="n">t</span><span class="p">)</span> <span class="p">=&gt;</span>
			<span class="p">{</span>
				<span class="k">const</span> <span class="kt">string</span> <span class="n">TargetTypeSuffix</span> <span class="p">=</span> <span class="s">"ViewModel"</span><span class="p">;</span>
				<span class="kt">var</span> <span class="n">isTypeWithTargetTypeSuffix</span> <span class="p">=</span> <span class="n">t</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="nf">EndsWith</span><span class="p">(</span><span class="n">TargetTypeSuffix</span><span class="p">);</span>
				<span class="k">return</span> <span class="p">(</span><span class="n">isTypeWithTargetTypeSuffix</span><span class="p">)</span>
					   <span class="p">&amp;&amp;</span> <span class="p">((</span><span class="n">sourceType</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="nf">EndsWith</span><span class="p">(</span><span class="s">"View"</span><span class="p">)</span> <span class="p">&amp;&amp;</span> <span class="n">sourceType</span><span class="p">.</span><span class="n">Name</span> <span class="p">+</span> <span class="s">"Model"</span> <span class="p">==</span> <span class="n">t</span><span class="p">.</span><span class="n">Name</span><span class="p">)</span>
						   <span class="p">||</span> <span class="p">(</span><span class="n">sourceType</span><span class="p">.</span><span class="n">Name</span> <span class="p">+</span> <span class="s">"ViewModel"</span> <span class="p">==</span> <span class="n">t</span><span class="p">.</span><span class="n">Name</span><span class="p">));</span>
			<span class="p">});</span>

		<span class="kt">var</span> <span class="n">resolvedTargetType</span> <span class="p">=</span> <span class="n">bindableBases</span><span class="p">.</span><span class="nf">FirstOrDefault</span><span class="p">(</span><span class="n">customConvention</span><span class="p">);</span>
		<span class="k">return</span> <span class="n">resolvedTargetType</span><span class="p">;</span>
	<span class="p">}</span>


	<span class="k">private</span> <span class="n">Type</span> <span class="nf">GetDefaultViewModelTypeFromViewType</span><span class="p">(</span><span class="n">Type</span> <span class="n">viewType</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="kt">var</span> <span class="n">viewName</span> <span class="p">=</span> <span class="n">viewType</span><span class="p">.</span><span class="n">FullName</span><span class="p">;</span>
		<span class="n">viewName</span> <span class="p">=</span> <span class="n">viewName</span><span class="p">.</span><span class="nf">Replace</span><span class="p">(</span><span class="s">".Views."</span><span class="p">,</span> <span class="s">".ViewModels."</span><span class="p">);</span>
		<span class="kt">var</span> <span class="n">viewAssemblyName</span> <span class="p">=</span> <span class="n">viewType</span><span class="p">.</span><span class="nf">GetTypeInfo</span><span class="p">().</span><span class="n">Assembly</span><span class="p">.</span><span class="n">FullName</span><span class="p">;</span>
		<span class="kt">var</span> <span class="n">suffix</span> <span class="p">=</span> <span class="n">viewName</span><span class="p">.</span><span class="nf">EndsWith</span><span class="p">(</span><span class="s">"View"</span><span class="p">)</span> <span class="p">?</span> <span class="s">"Model"</span> <span class="p">:</span> <span class="s">"ViewModel"</span><span class="p">;</span>
		<span class="kt">var</span> <span class="n">viewModelName</span> <span class="p">=</span> <span class="n">String</span><span class="p">.</span><span class="nf">Format</span><span class="p">(</span>
			<span class="n">CultureInfo</span><span class="p">.</span><span class="n">InvariantCulture</span><span class="p">,</span>
			<span class="s">"{0}{1}, {2}"</span><span class="p">,</span>
			<span class="n">viewName</span><span class="p">,</span>
			<span class="n">suffix</span><span class="p">,</span>
			<span class="n">viewAssemblyName</span><span class="p">);</span>
		<span class="k">return</span> <span class="n">Type</span><span class="p">.</span><span class="nf">GetType</span><span class="p">(</span><span class="n">viewModelName</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>

</pre></table></code></div></div><h4 id="use-the-custom-convention"><span class="mr-2">Use the custom convention</span><a href="#use-the-custom-convention" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>To use the custom convention, I created a new instance of IMvvmTypeLocator on the application BootStrapper. then i overrided the method ConfigureViewModelLocator.</p><h5 id="1st-step-1"><span class="mr-2">1st step</span><a href="#1st-step-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5></h5><p>Create field in the bootstrapper :</p><div class="language-csharp highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">private</span> <span class="n">IMvvmTypeLocator</span> <span class="n">mvvmTypeLocator</span><span class="p">;</span>
</pre></table></code></div></div><h5 id="2nd-step-1"><span class="mr-2">2nd step</span><a href="#2nd-step-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5></h5><p>Create new instance of the class MvvmTypeLocator once the AggregateCatalog is configured:</p><div class="language-csharp highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>
 <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">ConfigureAggregateCatalog</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">base</span><span class="p">.</span><span class="nf">ConfigureAggregateCatalog</span><span class="p">();</span>
            <span class="k">this</span><span class="p">.</span><span class="n">AggregateCatalog</span><span class="p">.</span><span class="n">Catalogs</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">new</span> <span class="nf">AssemblyCatalog</span><span class="p">(</span><span class="n">Assembly</span><span class="p">.</span><span class="nf">GetExecutingAssembly</span><span class="p">()));</span>
			<span class="c1">// Here i add the assembly containing all my view models.</span>
            <span class="k">this</span><span class="p">.</span><span class="n">AggregateCatalog</span><span class="p">.</span><span class="n">Catalogs</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">new</span> <span class="nf">AssemblyCatalog</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">MainViewModel</span><span class="p">).</span><span class="n">Assembly</span><span class="p">));</span>

			<span class="c1">// Create the new instnace of MvvmTypeLocator.</span>
            <span class="k">this</span><span class="p">.</span><span class="n">mvvmTypeLocator</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">MvvmTypeLocator</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">AggregateCatalog</span><span class="p">);</span>
        <span class="p">}</span>
</pre></table></code></div></div><h5 id="3rd-step-1"><span class="mr-2">3rd step</span><a href="#3rd-step-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5></h5><p>Apply the new convention to the ViewModelLocatorProvider:</p><div class="language-csharp highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>
<span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">ConfigureViewModelLocator</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">base</span><span class="p">.</span><span class="nf">ConfigureViewModelLocator</span><span class="p">();</span>

            <span class="n">ViewModelLocationProvider</span><span class="p">.</span><span class="nf">SetDefaultViewTypeToViewModelTypeResolver</span><span class="p">(</span>
                <span class="n">viewType</span> <span class="p">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="n">mvvmTypeLocator</span><span class="p">.</span><span class="nf">GetViewModelTypeFromViewType</span><span class="p">(</span><span class="n">viewType</span><span class="p">));</span>
        <span class="p">}</span>

</pre></table></code></div></div><blockquote class="prompt-note"><div><p>Note that you are responsible of the view model naming, because this convention will allow the view model locator returning the first found occurence, then ensure that this view model type name is unique.</p></div></blockquote></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/development/'>Development</a>, <a href='/categories/net/'>.NET</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/csharp/" class="post-tag no-text-decoration" >csharp</a> <a href="/tags/dotnet/" class="post-tag no-text-decoration" >dotnet</a> <a href="/tags/tutorial/" class="post-tag no-text-decoration" >tutorial</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/"> CC BY-NC-SA 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Prism: View Model Locator =&gt; Custom Convention - Younes&#39;s blog&amp;url=https://cyounes.com/posts/prism-custom-view-model-locator/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p[title]=Prism: View Model Locator =&gt; Custom Convention - Younes&#39;s blog&amp;p[url]=https://cyounes.com/posts/prism-custom-view-model-locator/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://cyounes.com/posts/prism-custom-view-model-locator/&amp;text=Prism: View Model Locator =&gt; Custom Convention - Younes&#39;s blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://cyounes.com/posts/prism-custom-view-model-locator/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/prism-custom-view-model-locator/">Prism: View Model Locator => Custom Convention</a><li><a href="/posts/walletix-java-api/">Walletix Java API</a><li><a href="/posts/walletix-python-api/">Walletix Python API</a><li><a href="/posts/termcolor/">Termcolor Library</a><li><a href="/posts/observable-concurrent-queue/">Observable Concurrent Queue</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/tutorial/">tutorial</a> <a class="post-tag" href="/tags/c/">c</a> <a class="post-tag" href="/tags/csharp/">csharp</a> <a class="post-tag" href="/tags/dotnet/">dotnet</a> <a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/cliargs/">cliargs</a> <a class="post-tag" href="/tags/open-source/">open-source</a> <a class="post-tag" href="/tags/puzzle/">puzzle</a> <a class="post-tag" href="/tags/algorithm/">algorithm</a> <a class="post-tag" href="/tags/automation/">automation</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Set-Session-Key-for-Dto/"><div class="card-body"> <em class="timeago small" data-ts="1485212400" > 2017-01-24 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Set a dto session key when calling WCF proxy</h3><div class="text-muted small"><p> The power of the following method is avoid implementing the WCF contract client in the client side and duplicate the code for each call. Using Reflections and Expression Lambda to handle each messa...</p></div></div></a></div><div class="card"> <a href="/posts/observable-concurrent-queue/"><div class="card-body"> <em class="timeago small" data-ts="1420153200" > 2015-01-02 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Observable Concurrent Queue</h3><div class="text-muted small"><p> I was working with the classic ConcurrentQueue in .Net, Itâ€™s a good practice to schedule tasks execution asynchronously, however, getting notified when my ConcurrentQueue content is changed was t...</p></div></div></a></div><div class="card"> <a href="/posts/first-release-of-cliargs/"><div class="card-body"> <em class="timeago small" data-ts="1645971540" > 2022-02-27 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>First release of Cliargs.NET</h3><div class="text-muted small"><p> For those following me on Twitter, I was sharing some notes about Cliargs.NET during the last weeks, so I ended up by publishing the first release on Nuget last days. Background Since Iâ€™ve started...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/observable-concurrent-queue/" class="btn btn-outline-primary" prompt="Older"><p>Observable Concurrent Queue</p></a> <a href="/posts/Set-Session-Key-for-Dto/" class="btn btn-outline-primary" prompt="Newer"><p>Set a dto session key when calling WCF proxy</p></a></div><script type="text/javascript"> $(function () { const origin = "https://giscus.app"; const iframe = "iframe.giscus-frame"; const lightTheme = "light"; const darkTheme = "dark_dimmed"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } let giscusAttributes = { "src": "https://giscus.app/client.js", "data-repo": "YounesCheikh/younescheikh.github.io", "data-repo-id": "R_kgDOG6o9fg", "data-category": "Comments", "data-category-id": "DIC_kwDOG6o9fs4CN9P3", "data-mapping": "pathname", "data-reactions-enabled": "1", "data-emit-metadata": "0", "data-theme": initTheme, "data-input-position": "top", "data-lang": "en", "crossorigin": "anonymous", "async": "" }; let giscusScript = document.createElement("script"); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value)); document.getElementById("tail-wrapper").appendChild(giscusScript); addEventListener("message", (event) => { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; const theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); }); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> Â© 2024 <a href="https://twitter.com/YounesCheikh">Younes Cheikh</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY-NC-SA 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/tutorial/">tutorial</a> <a class="post-tag" href="/tags/c/">c</a> <a class="post-tag" href="/tags/csharp/">csharp</a> <a class="post-tag" href="/tags/dotnet/">dotnet</a> <a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/cliargs/">cliargs</a> <a class="post-tag" href="/tags/open-source/">open-source</a> <a class="post-tag" href="/tags/puzzle/">puzzle</a> <a class="post-tag" href="/tags/algorithm/">algorithm</a> <a class="post-tag" href="/tags/automation/">automation</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
